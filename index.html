<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Update</title> <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        /* ... (CSS ‡∏™‡πà‡∏ß‡∏ô Theme Neon ‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡πÉ‡∏™‡πà‡πÑ‡∏ß‡πâ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ) ... */
        :root {
            --bg-color: #0f0f12; --container-bg: #18181b;
            --primary-color: #6366f1; --secondary-color: #8b5cf6;
            --text-primary: #f3f4f6; --text-secondary: #9ca3af;
            --incoming-bg: #27272a; --border-color: #3f3f46;
            --error-color: #ef4444;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { 
            background-color: var(--bg-color); color: var(--text-primary); 
            font-family: 'Inter', sans-serif; height: 100vh; display: flex; justify-content: center; overflow: hidden; 
        }

        /* --- üî• ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏´‡∏•‡∏≠‡∏Å (Fake Screen) --- */
        #fake-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: #fff; /* ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Ç‡∏≤‡∏ß */
            color: #000;
            z-index: 99999; /* ‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô‡∏™‡∏∏‡∏î */
            display: none; /* ‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô */
            flex-direction: column; justify-content: center; align-items: center;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .fake-content { text-align: center; }
        .spinner {
            border: 4px solid #f3f3f3; border-top: 4px solid #3498db;
            border-radius: 50%; width: 40px; height: 40px;
            animation: spin 1s linear infinite; margin: 0 auto 20px auto;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* ... (CSS ‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì) ... */
        #toast-container { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); z-index: 200; width: 90%; pointer-events: none; }
        .toast { background: rgba(30, 30, 36, 0.95); border: 1px solid var(--border-color); color: white; padding: 12px 20px; border-radius: 50px; opacity: 0; transition: 0.3s; }
        .toast.show { opacity: 1; }
        .toast.error { border-color: var(--error-color); color: var(--error-color); }
        #login-screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, #1e1e24 0%, #0f0f12 100%); z-index: 100; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        .login-box { background: var(--container-bg); padding: 30px; border-radius: 20px; width: 300px; text-align: center; }
        .login-input { width: 100%; padding: 10px; margin-bottom: 10px; background: #333; border: none; color: white; border-radius: 5px; }
        #login-btn { width: 100%; padding: 10px; background: var(--primary-color); border: none; color: white; border-radius: 5px; cursor: pointer; }
        .app-container { width: 100%; max-width: 600px; display: none; flex-direction: column; height: 100%; background: var(--container-bg); }
        header { padding: 15px; background: #111; display: flex; justify-content: space-between; align-items: center; }
        #messages { flex-grow: 1; overflow-y: auto; padding: 20px; list-style: none; }
        .message-box { padding: 10px; margin-bottom: 10px; border-radius: 10px; max-width: 80%; word-wrap: break-word;}
        .incoming { background: var(--incoming-bg); align-self: flex-start; }
        .outgoing { background: var(--primary-color); align-self: flex-end; margin-left: auto; }
        #form { display: flex; padding: 10px; background: #111; }
        #input { flex-grow: 1; padding: 10px; border-radius: 20px; border: none; background: #333; color: white; }
        .icon-btn { background: none; border: none; color: var(--primary-color); cursor: pointer; padding: 10px; }
        #file-input { display: none; }
        .chat-image { max-width: 100%; border-radius: 10px; }
    </style>
</head>
<body>

    <div id="fake-screen">
        <div class="fake-content">
            <div class="spinner"></div>
            <h2 style="color: #333;">Windows Update</h2>
            <p style="color: #666;">Configuring updates 35% complete.<br>Don't turn off your computer.</p>
        </div>
    </div>

    <div id="toast-container"></div>
    <div id="login-screen">
        <div class="login-box">
            <h2 style="color: white; margin-bottom: 20px;">SYSTEM LOGIN</h2>
            <input id="username-input" class="login-input" placeholder="User" autocomplete="off">
            <input id="room-input" class="login-input" placeholder="ID" autocomplete="off">
            <input id="password-input" class="login-input" type="password" placeholder="Key" autocomplete="off">
            <button id="login-btn">CONNECT</button>
        </div>
    </div>
    <div class="app-container" id="app">
        <header>
            <span id="room-display" style="color: white; font-weight: bold;">LOBBY</span>
            <span style="font-size: 0.8rem; color: #aaa;">üü¢ Online</span>
        </header>
        <ul id="messages"></ul>
        <form id="form" action="">
            <button type="button" class="icon-btn" onclick="document.getElementById('file-input').click()">üì∑</button>
            <input type="file" id="file-input" accept="image/*">
            <input id="input" autocomplete="off" placeholder="Type..." />
            <button class="icon-btn" id="send-btn">‚û§</button>
        </form>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        var socket = io();
        // ... (‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏î‡∏¥‡∏°) ...
        var fakeScreen = document.getElementById('fake-screen');

        // --- üî• ‡∏£‡∏∞‡∏ö‡∏ö Panic Button (‡∏Å‡∏î ESC ‡∏™‡∏•‡∏±‡∏ö‡∏à‡∏≠) ---
        document.addEventListener('keydown', function(event) {
            // ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° ESC ‡∏´‡∏£‡∏∑‡∏≠ F2
            if (event.key === "Escape" || event.key === "F2") {
                if (fakeScreen.style.display === "flex") {
                    fakeScreen.style.display = "none"; // ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ä‡∏ó
                    document.title = "System Login";
                } else {
                    fakeScreen.style.display = "flex"; // ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏≠‡∏Å
                    document.title = "Windows Update"; // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠ Tab ‡∏´‡∏•‡∏≠‡∏Å‡∏î‡πâ‡∏ß‡∏¢
                }
            }
        });

        // ... (Script ‡∏™‡πà‡∏ß‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ‡πÉ‡∏™‡πà‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°) ...
        var loginBtn = document.getElementById('login-btn');
        var usernameInput = document.getElementById('username-input');
        var roomInput = document.getElementById('room-input');
        var passwordInput = document.getElementById('password-input');
        var appScreen = document.getElementById('app');
        var loginScreen = document.getElementById('login-screen');
        var messages = document.getElementById('messages');
        var form = document.getElementById('form');
        var input = document.getElementById('input');
        var fileInput = document.getElementById('file-input');
        var myUsername = "";

        loginBtn.addEventListener('click', function() {
            if (usernameInput.value && roomInput.value) {
                myUsername = usernameInput.value;
                socket.emit('join room', { username: myUsername, room: roomInput.value, password: passwordInput.value });
            }
        });

        socket.on('system message', function(msg) {
            loginScreen.style.display = 'none'; appScreen.style.display = 'flex';
            var item = document.createElement('li'); item.style.textAlign = 'center'; item.innerText = msg; messages.appendChild(item);
        });

        socket.on('chat message', function(data) {
           var item = document.createElement('li');
           item.className = 'message-box ' + (data.user === myUsername ? 'outgoing' : 'incoming');
           if(data.type === 'image') { item.innerHTML = `<b>${data.user}</b><br><img src="${data.img}" class="chat-image">`; } 
           else { item.innerHTML = `<b>${data.user}</b><br>${data.msg}`; }
           messages.appendChild(item);
        });

        form.addEventListener('submit', function(e) { e.preventDefault(); if (input.value) { socket.emit('chat message', input.value); input.value = ''; } });
        fileInput.addEventListener('change', function() { /* ‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡πà‡∏á‡∏£‡∏π‡∏õ‡πÄ‡∏î‡∏¥‡∏° */ });
    </script>
</body>
</html>